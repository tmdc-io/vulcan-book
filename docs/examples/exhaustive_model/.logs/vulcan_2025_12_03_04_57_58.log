2025-12-03 04:57:58,248 - MainThread - vulcan.core.state_sync.common - INFO - Cleaned up 0 expired snapshots (janitor.py:181)
2025-12-03 04:57:58,251 - MainThread - vulcan.core.state_sync.db.interval - INFO - Compacting 0 intervals for 0 snapshots (interval.py:130)
2025-12-03 04:57:58,606 - ThreadPoolExecutor-0_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__vulcan_demo (evaluator.py:1610)
2025-12-03 04:57:58,608 - ThreadPoolExecutor-0_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:58,622 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model": 2553446276> (evaluator.py:711)
2025-12-03 04:57:58,623 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."incremental_by_unique_key_py": 1389052163> (evaluator.py:711)
2025-12-03 04:57:58,624 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."partition": 904715744> (evaluator.py:711)
2025-12-03 04:57:58,625 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model_py": 1196569793> (evaluator.py:711)
2025-12-03 04:57:58,625 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model": 2553446276> (evaluator.py:952)
2025-12-03 04:57:58,634 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__full_model__3230895180' (evaluator.py:984)
2025-12-03 04:57:58,634 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:58,635 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."incremental_by_unique_key_py": 1389052163> (evaluator.py:952)
2025-12-03 04:57:58,635 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition": 904715744> (evaluator.py:952)
2025-12-03 04:57:58,648 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__partition__344634559' (evaluator.py:984)
2025-12-03 04:57:58,649 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model_py": 1196569793> (evaluator.py:952)
2025-12-03 04:57:58,650 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__incremental_by_unique_key_py__2155627825' (evaluator.py:984)
2025-12-03 04:57:58,652 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,653 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" WHERE TRUE (base.py:2622)
2025-12-03 04:57:58,654 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SHOW server_version (base.py:2622)
2025-12-03 04:57:58,656 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" ("customer_id", "customer_name", "email", "total_orders", "total_spent", "avg_order_value") SELECT "c"."customer_id" AS "customer_id", "c"."name" AS "customer_name", "c"."email" AS "email", COUNT(DISTINCT "o"."order_id") AS "total_orders", COALESCE(SUM("oi"."quantity" * "oi"."unit_price"), 0) AS "total_spent", COALESCE(SUM("oi"."quantity" * "oi"."unit_price"), 0) / NULLIF(COUNT(DISTINCT "o"."order_id"), 0) AS "avg_order_value" FROM "warehouse"."vulcan_demo"."customers" AS "c" LEFT JOIN "warehouse"."vulcan_demo"."orders" AS "o" ON "c"."customer_id" = "o"."customer_id" LEFT JOIN "warehouse"."vulcan_demo"."order_items" AS "oi" ON "o"."order_id" = "oi"."order_id" GROUP BY "c"."customer_id", "c"."name", "c"."email" ORDER BY "total_spent" DESC (base.py:2622)
2025-12-03 04:57:58,663 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__full_model_py__1159036023' (evaluator.py:984)
2025-12-03 04:57:58,667 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE "vulcan__vulcan_demo"."__temp_vulcan_demo__partition__344634559_600a57zr" AS SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("warehouse_name" AS TEXT) AS "warehouse_name", CAST("category" AS TEXT) AS "category", CAST("order_date" AS TIMESTAMP) AS "order_date", CAST("partitioned_analysis_key" AS TEXT) AS "partitioned_analysis_key", CAST("total_transactions" AS BIGINT) AS "total_transactions", CAST("total_quantity_sold" AS BIGINT) AS "total_quantity_sold", CAST("total_sales_amount" AS DECIMAL) AS "total_sales_amount", CAST("avg_transaction_value" AS DECIMAL) AS "avg_transaction_value", CAST("unique_customers" AS BIGINT) AS "unique_customers", CAST("unique_products" AS BIGINT) AS "unique_products", CAST("avg_order_value" AS DECIMAL) AS "avg_order_value", CAST("revenue_per_customer" AS DECIMAL) AS "revenue_per_customer", CAST("category_rank_in_warehouse" AS BIGINT) AS "category_rank_in_warehouse" FROM (SELECT "w"."warehouse_id" AS "warehouse_id", "w"."name" AS "warehouse_name", "p"."category" AS "category", "o"."order_date" AS "order_date", CONCAT(CAST("w"."warehouse_id" AS TEXT), '_', "p"."category", '_', CAST("o"."order_date" AS TEXT)) AS "partitioned_analysis_key", COUNT(DISTINCT "o"."order_id") AS "total_transactions", SUM("oi"."quantity") AS "total_quantity_sold", SUM("oi"."quantity" * "oi"."unit_price") AS "total_sales_amount", AVG("oi"."quantity" * "oi"."unit_price") AS "avg_transaction_value", COUNT(DISTINCT "o"."customer_id") AS "unique_customers", COUNT(DISTINCT "oi"."product_id") AS "unique_products", ROUND(SUM("oi"."quantity" * "oi"."unit_price") / NULLIF(COUNT(DISTINCT "o"."order_id"), 0), 2) AS "avg_order_value", ROUND(SUM("oi"."quantity" * "oi"."unit_price") / NULLIF(COUNT(DISTINCT "o"."customer_id"), 0), 2) AS "revenue_per_customer", RANK() OVER (PARTITION BY "w"."warehouse_id", "o"."order_date" ORDER BY SUM("oi"."quantity" * "oi"."unit_price") DESC) AS "category_rank_in_warehouse" FROM "warehouse"."vulcan_demo"."orders" AS "o" JOIN "warehouse"."vulcan_demo"."order_items" AS "oi" ON "o"."order_id" = "oi"."order_id" JOIN "warehouse"."vulcan_demo"."products" AS "p" ON "oi"."product_id" = "p"."product_id" JOIN "warehouse"."vulcan_demo"."warehouses" AS "w" ON "o"."warehouse_id" = "w"."warehouse_id" GROUP BY "w"."warehouse_id", "w"."name", "p"."category", "o"."order_date" ORDER BY "warehouse_id", "order_date", "total_sales_amount" DESC) AS "_subquery" (base.py:2622)
2025-12-03 04:57:58,669 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: MERGE INTO "vulcan__vulcan_demo"."vulcan_demo__incremental_by_unique_key_py__2155627825" AS "__MERGE_TARGET__" USING (SELECT CAST("customer_id" AS INT) AS "customer_id", CAST("total_spent" AS DECIMAL(10, 2)) AS "total_spent", CAST("last_order_date" AS DATE) AS "last_order_date" FROM (VALUES "<REDACTED VALUES>") AS "t"("customer_id", "total_spent", "last_order_date")) AS "__MERGE_SOURCE__" ON "__MERGE_TARGET__"."customer_id" = "__MERGE_SOURCE__"."customer_id" WHEN MATCHED THEN UPDATE SET "customer_id" = "__MERGE_SOURCE__"."customer_id", "total_spent" = "__MERGE_SOURCE__"."total_spent", "last_order_date" = "__MERGE_SOURCE__"."last_order_date" WHEN NOT MATCHED THEN INSERT ("customer_id", "total_spent", "last_order_date") VALUES ("__MERGE_SOURCE__"."customer_id", "__MERGE_SOURCE__"."total_spent", "__MERGE_SOURCE__"."last_order_date") (base.py:2622)
2025-12-03 04:57:58,669 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:58,669 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model": 2553446276> (evaluator.py:603)
2025-12-03 04:57:58,673 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,681 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__full_model_py__1159036023" WHERE TRUE (base.py:2622)
2025-12-03 04:57:58,681 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."incremental_by_unique_key_py": 1389052163> (facade.py:726)
2025-12-03 04:57:58,691 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."incremental_by_unique_key_py": 1389052163> (interval.py:215)
2025-12-03 04:57:58,687 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__partition__344634559" WHERE CONCAT_WS('__VULCAN_DELIM__', "warehouse_id", "category") IN (SELECT DISTINCT CONCAT_WS('__VULCAN_DELIM__', "warehouse_id", "category") FROM "vulcan__vulcan_demo"."__temp_vulcan_demo__partition__344634559_600a57zr") (base.py:2622)
2025-12-03 04:57:58,691 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__full_model_py__1159036023" ("product_id", "product_name", "category", "total_sales") SELECT CAST("product_id" AS INT) AS "product_id", CAST("product_name" AS TEXT) AS "product_name", CAST("category" AS TEXT) AS "category", CAST("total_sales" AS DECIMAL(10, 2)) AS "total_sales" FROM (VALUES "<REDACTED VALUES>") AS "t"("product_id", "product_name", "category", "total_sales") (base.py:2622)
2025-12-03 04:57:58,687 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY "customer_id" ORDER BY "customer_id" NULLS FIRST) AS "rank_customer_id" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE TRUE) AS "_q_0" WHERE "rank_customer_id" > 1) AS "audit" (base.py:2622)
2025-12-03 04:57:58,696 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,699 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__partition__344634559" ("warehouse_id", "warehouse_name", "category", "order_date", "partitioned_analysis_key", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_transaction_value", "unique_customers", "unique_products", "avg_order_value", "revenue_per_customer", "category_rank_in_warehouse") SELECT "warehouse_id", "warehouse_name", "category", "order_date", "partitioned_analysis_key", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_transaction_value", "unique_customers", "unique_products", "avg_order_value", "revenue_per_customer", "category_rank_in_warehouse" FROM "vulcan__vulcan_demo"."__temp_vulcan_demo__partition__344634559_600a57zr" (base.py:2622)
2025-12-03 04:57:58,701 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model_py": 1196569793> (facade.py:726)
2025-12-03 04:57:58,706 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE ("customer_id" IS NULL OR "customer_name" IS NULL) AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,706 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__partition__344634559_600a57zr" (base.py:2622)
2025-12-03 04:57:58,706 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model_py": 1196569793> (interval.py:215)
2025-12-03 04:57:58,707 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."partition_py": 2905169826> (evaluator.py:711)
2025-12-03 04:57:58,710 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,713 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition_py": 2905169826> (evaluator.py:952)
2025-12-03 04:57:58,713 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"warehouse"."vulcan_demo"."partition": 904715744> (evaluator.py:603)
2025-12-03 04:57:58,720 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE "customer_name" = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,726 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,733 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column": 3563531193> (evaluator.py:711)
2025-12-03 04:57:58,740 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__partition_py__1375961574' (evaluator.py:984)
2025-12-03 04:57:58,741 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column": 3563531193> (evaluator.py:952)
2025-12-03 04:57:58,745 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY "partitioned_analysis_key" ORDER BY "partitioned_analysis_key" NULLS FIRST) AS "rank_partitioned_analysis_key" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE TRUE) AS "_q_0" WHERE "rank_partitioned_analysis_key" > 1) AS "audit" (base.py:2622)
2025-12-03 04:57:58,747 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,777 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__scd_type2_by_column__1318279303' (evaluator.py:984)
2025-12-03 04:57:58,780 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp" AS SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (VALUES "<REDACTED VALUES>") AS "t"("warehouse_id", "order_date", "daily_revenue")) AS "_subquery" (base.py:2622)
2025-12-03 04:57:58,782 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,784 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,790 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE "total_orders" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,815 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp" ("warehouse_id", "order_date", "daily_revenue") SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (VALUES "<REDACTED VALUES>") AS "t"("warehouse_id", "order_date", "daily_revenue")) AS "_subquery" (base.py:2622)
2025-12-03 04:57:58,831 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE ("warehouse_id" IS NULL OR "warehouse_name" IS NULL OR "category" IS NULL OR "order_date" IS NULL OR "partitioned_analysis_key" IS NULL) AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,841 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:58,843 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,857 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp" ("warehouse_id", "order_date", "daily_revenue") SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (SELECT CAST("warehouse_id" AS INT) AS "warehouse_id", CAST("order_date" AS DATE) AS "order_date", CAST("daily_revenue" AS DECIMAL(10, 2)) AS "daily_revenue" FROM (VALUES "<REDACTED VALUES>") AS "t"("warehouse_id", "order_date", "daily_revenue")) AS "_subquery" (base.py:2622)
2025-12-03 04:57:58,859 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" ("product_id" INT, "product_name" TEXT, "category" TEXT, "price" DECIMAL(10, 2), "supplier_name" TEXT, "region_name" TEXT, "total_orders" BIGINT, "total_quantity_sold" BIGINT, "total_sales_amount" DECIMAL, "avg_selling_price" DOUBLE PRECISION, "unique_customers" BIGINT, "valid_from" TIMESTAMP, "valid_to" TIMESTAMP) (base.py:2622)
2025-12-03 04:57:58,860 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."product_id" IS 'Product ID' (base.py:2622)
2025-12-03 04:57:58,861 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__partition_py__1375961574" WHERE "warehouse_id" IN (SELECT DISTINCT "warehouse_id" FROM "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp") (base.py:2622)
2025-12-03 04:57:58,861 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."product_name" IS 'Product Name' (base.py:2622)
2025-12-03 04:57:58,938 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."category" IS 'Product Category' (base.py:2622)
2025-12-03 04:57:58,944 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."price" IS 'Product Price' (base.py:2622)
2025-12-03 04:57:58,945 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__partition_py__1375961574" ("warehouse_id", "order_date", "daily_revenue") SELECT "warehouse_id", "order_date", "daily_revenue" FROM "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp" (base.py:2622)
2025-12-03 04:57:58,946 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,948 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."supplier_name" IS 'Supplier Name' (base.py:2622)
2025-12-03 04:57:58,960 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE "total_spent" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,961 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__partition_py__1375961574_vh5wf7yp" (base.py:2622)
2025-12-03 04:57:58,970 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."region_name" IS 'Region Name' (base.py:2622)
2025-12-03 04:57:58,973 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."total_orders" IS 'Total Orders' (base.py:2622)
2025-12-03 04:57:58,975 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303"."total_quantity_sold" IS 'Total Quantity Sold' (base.py:2622)
2025-12-03 04:57:58,976 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition_py": 2905169826> (facade.py:726)
2025-12-03 04:57:58,976 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition_py": 2905169826> (interval.py:215)
2025-12-03 04:57:58,985 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "vulcan__vulcan_demo" (base.py:2622)
2025-12-03 04:57:58,987 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__full_model__3230895180') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:58,987 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE ("warehouse_name") = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:58,993 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column__1318279303_57lg6yil" AS SELECT CAST("product_id" AS INT) AS "product_id", CAST("product_name" AS TEXT) AS "product_name", CAST("category" AS TEXT) AS "category", CAST("price" AS DECIMAL(10, 2)) AS "price", CAST("supplier_name" AS TEXT) AS "supplier_name", CAST("region_name" AS TEXT) AS "region_name", CAST("total_orders" AS BIGINT) AS "total_orders", CAST("total_quantity_sold" AS BIGINT) AS "total_quantity_sold", CAST("total_sales_amount" AS DECIMAL) AS "total_sales_amount", CAST("avg_selling_price" AS DOUBLE PRECISION) AS "avg_selling_price", CAST("unique_customers" AS BIGINT) AS "unique_customers", CAST("valid_from" AS TIMESTAMP) AS "valid_from", CAST("valid_to" AS TIMESTAMP) AS "valid_to" FROM (SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to" FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303") AS "_subquery" (base.py:2622)
2025-12-03 04:57:59,007 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__full_model__3230895180" AS "vulcan_demo__full_model__3230895180" WHERE "avg_order_value" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,015 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,019 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model": 2553446276> (facade.py:726)
2025-12-03 04:57:59,025 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."full_model": 2553446276> (interval.py:215)
2025-12-03 04:57:59,036 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE "total_sales_amount" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,042 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" WHERE TRUE (base.py:2622)
2025-12-03 04:57:59,043 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column_py": 846708042> (evaluator.py:711)
2025-12-03 04:57:59,051 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column_py": 846708042> (evaluator.py:952)
2025-12-03 04:57:59,065 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" ("product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to") WITH "source" AS (SELECT DISTINCT ON ("product_id") TRUE AS "_exists", "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers" FROM (SELECT "p"."product_id" AS "product_id", "p"."name" AS "product_name", "p"."category" AS "category", "p"."price" AS "price", "s"."name" AS "supplier_name", "r"."region_name" AS "region_name", COUNT(DISTINCT "oi"."order_id") * 0 AS "total_orders", SUM("oi"."quantity") AS "total_quantity_sold", SUM("oi"."quantity" * "oi"."unit_price") AS "total_sales_amount", AVG("oi"."unit_price") AS "avg_selling_price", COUNT(DISTINCT "o"."customer_id") AS "unique_customers" FROM "warehouse"."vulcan_demo"."products" AS "p" LEFT JOIN "warehouse"."vulcan_demo"."suppliers" AS "s" ON "p"."supplier_id" = "s"."supplier_id" LEFT JOIN "warehouse"."vulcan_demo"."regions" AS "r" ON "r"."region_id" = "s"."region_id" LEFT JOIN "warehouse"."vulcan_demo"."order_items" AS "oi" ON "oi"."product_id" = "p"."product_id" LEFT JOIN "warehouse"."vulcan_demo"."orders" AS "o" ON "o"."order_id" = "oi"."order_id" GROUP BY "p"."product_id", "p"."name", "p"."category", "p"."price", "s"."name", "r"."region_name" ORDER BY "product_id") AS "raw_source"), "static" AS (SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column__1318279303_57lg6yil" WHERE NOT "valid_to" IS NULL), "latest" AS (SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column__1318279303_57lg6yil" WHERE "valid_to" IS NULL), "deleted" AS (SELECT "static"."product_id", "static"."product_name", "static"."category", "static"."price", "static"."supplier_name", "static"."region_name", "static"."total_orders", "static"."total_quantity_sold", "static"."total_sales_amount", "static"."avg_selling_price", "static"."unique_customers", "static"."valid_from", "static"."valid_to" FROM "static" LEFT JOIN "latest" ON "static"."product_id" = "latest"."product_id" WHERE "latest"."valid_to" IS NULL), "latest_deleted" AS (SELECT TRUE AS "_exists", "product_id" AS "_key0", MAX("valid_to") AS "valid_to" FROM "deleted" GROUP BY "product_id"), "joined" AS (SELECT "source"."_exists" AS "_exists", "latest"."product_id" AS "t_product_id", "latest"."product_name" AS "t_product_name", "latest"."category" AS "t_category", "latest"."price" AS "t_price", "latest"."supplier_name" AS "t_supplier_name", "latest"."region_name" AS "t_region_name", "latest"."total_orders" AS "t_total_orders", "latest"."total_quantity_sold" AS "t_total_quantity_sold", "latest"."total_sales_amount" AS "t_total_sales_amount", "latest"."avg_selling_price" AS "t_avg_selling_price", "latest"."unique_customers" AS "t_unique_customers", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."product_id" AS "product_id", "source"."product_name" AS "product_name", "source"."category" AS "category", "source"."price" AS "price", "source"."supplier_name" AS "supplier_name", "source"."region_name" AS "region_name", "source"."total_orders" AS "total_orders", "source"."total_quantity_sold" AS "total_quantity_sold", "source"."total_sales_amount" AS "total_sales_amount", "source"."avg_selling_price" AS "avg_selling_price", "source"."unique_customers" AS "unique_customers" FROM "latest" LEFT JOIN "source" ON "latest"."product_id" = "source"."product_id" UNION ALL SELECT "source"."_exists" AS "_exists", "latest"."product_id" AS "t_product_id", "latest"."product_name" AS "t_product_name", "latest"."category" AS "t_category", "latest"."price" AS "t_price", "latest"."supplier_name" AS "t_supplier_name", "latest"."region_name" AS "t_region_name", "latest"."total_orders" AS "t_total_orders", "latest"."total_quantity_sold" AS "t_total_quantity_sold", "latest"."total_sales_amount" AS "t_total_sales_amount", "latest"."avg_selling_price" AS "t_avg_selling_price", "latest"."unique_customers" AS "t_unique_customers", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."product_id" AS "product_id", "source"."product_name" AS "product_name", "source"."category" AS "category", "source"."price" AS "price", "source"."supplier_name" AS "supplier_name", "source"."region_name" AS "region_name", "source"."total_orders" AS "total_orders", "source"."total_quantity_sold" AS "total_quantity_sold", "source"."total_sales_amount" AS "total_sales_amount", "source"."avg_selling_price" AS "avg_selling_price", "source"."unique_customers" AS "unique_customers" FROM "latest" RIGHT JOIN "source" ON "latest"."product_id" = "source"."product_id" WHERE "latest"."_exists" IS NULL), "updated_rows" AS (SELECT COALESCE("joined"."t_product_id", "joined"."product_id") AS "product_id", COALESCE("joined"."t_product_name", "joined"."product_name") AS "product_name", COALESCE("joined"."t_category", "joined"."category") AS "category", COALESCE("joined"."t_price", "joined"."price") AS "price", COALESCE("joined"."t_supplier_name", "joined"."supplier_name") AS "supplier_name", COALESCE("joined"."t_region_name", "joined"."region_name") AS "region_name", COALESCE("joined"."t_total_orders", "joined"."total_orders") AS "total_orders", COALESCE("joined"."t_total_quantity_sold", "joined"."total_quantity_sold") AS "total_quantity_sold", COALESCE("joined"."t_total_sales_amount", "joined"."total_sales_amount") AS "total_sales_amount", COALESCE("joined"."t_avg_selling_price", "joined"."avg_selling_price") AS "avg_selling_price", COALESCE("joined"."t_unique_customers", "joined"."unique_customers") AS "unique_customers", COALESCE("t_valid_from", CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP)) AS "valid_from", CASE WHEN (NOT "joined"."t_product_id" IS NULL AND NOT "joined"."product_id" IS NULL) AND ("joined"."product_name" <> "joined"."t_product_name" OR ("joined"."t_product_name" IS NULL AND NOT "joined"."product_name" IS NULL) OR (NOT "joined"."t_product_name" IS NULL AND "joined"."product_name" IS NULL) OR "joined"."category" <> "joined"."t_category" OR ("joined"."t_category" IS NULL AND NOT "joined"."category" IS NULL) OR (NOT "joined"."t_category" IS NULL AND "joined"."category" IS NULL) OR "joined"."price" <> "joined"."t_price" OR ("joined"."t_price" IS NULL AND NOT "joined"."price" IS NULL) OR (NOT "joined"."t_price" IS NULL AND "joined"."price" IS NULL) OR "joined"."supplier_name" <> "joined"."t_supplier_name" OR ("joined"."t_supplier_name" IS NULL AND NOT "joined"."supplier_name" IS NULL) OR (NOT "joined"."t_supplier_name" IS NULL AND "joined"."supplier_name" IS NULL) OR "joined"."region_name" <> "joined"."t_region_name" OR ("joined"."t_region_name" IS NULL AND NOT "joined"."region_name" IS NULL) OR (NOT "joined"."t_region_name" IS NULL AND "joined"."region_name" IS NULL) OR "joined"."total_orders" <> "joined"."t_total_orders" OR ("joined"."t_total_orders" IS NULL AND NOT "joined"."total_orders" IS NULL) OR (NOT "joined"."t_total_orders" IS NULL AND "joined"."total_orders" IS NULL) OR "joined"."total_quantity_sold" <> "joined"."t_total_quantity_sold" OR ("joined"."t_total_quantity_sold" IS NULL AND NOT "joined"."total_quantity_sold" IS NULL) OR (NOT "joined"."t_total_quantity_sold" IS NULL AND "joined"."total_quantity_sold" IS NULL)) THEN CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP) ELSE "t_valid_to" END AS "valid_to" FROM "joined" LEFT JOIN "latest_deleted" ON "joined"."product_id" = "latest_deleted"."_key0"), "inserted_rows" AS (SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP) AS "valid_from", CAST(NULL AS TIMESTAMP) AS "valid_to" FROM "joined" WHERE (NOT "joined"."t_product_id" IS NULL AND NOT "joined"."product_id" IS NULL) AND ("joined"."product_name" <> "joined"."t_product_name" OR ("joined"."t_product_name" IS NULL AND NOT "joined"."product_name" IS NULL) OR (NOT "joined"."t_product_name" IS NULL AND "joined"."product_name" IS NULL) OR "joined"."category" <> "joined"."t_category" OR ("joined"."t_category" IS NULL AND NOT "joined"."category" IS NULL) OR (NOT "joined"."t_category" IS NULL AND "joined"."category" IS NULL) OR "joined"."price" <> "joined"."t_price" OR ("joined"."t_price" IS NULL AND NOT "joined"."price" IS NULL) OR (NOT "joined"."t_price" IS NULL AND "joined"."price" IS NULL) OR "joined"."supplier_name" <> "joined"."t_supplier_name" OR ("joined"."t_supplier_name" IS NULL AND NOT "joined"."supplier_name" IS NULL) OR (NOT "joined"."t_supplier_name" IS NULL AND "joined"."supplier_name" IS NULL) OR "joined"."region_name" <> "joined"."t_region_name" OR ("joined"."t_region_name" IS NULL AND NOT "joined"."region_name" IS NULL) OR (NOT "joined"."t_region_name" IS NULL AND "joined"."region_name" IS NULL) OR "joined"."total_orders" <> "joined"."t_total_orders" OR ("joined"."t_total_orders" IS NULL AND NOT "joined"."total_orders" IS NULL) OR (NOT "joined"."t_total_orders" IS NULL AND "joined"."total_orders" IS NULL) OR "joined"."total_quantity_sold" <> "joined"."t_total_quantity_sold" OR ("joined"."t_total_quantity_sold" IS NULL AND NOT "joined"."total_quantity_sold" IS NULL) OR (NOT "joined"."t_total_quantity_sold" IS NULL AND "joined"."total_quantity_sold" IS NULL))) SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to" FROM "static" UNION ALL SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to" FROM "updated_rows" UNION ALL SELECT "product_id", "product_name", "category", "price", "supplier_name", "region_name", "total_orders", "total_quantity_sold", "total_sales_amount", "avg_selling_price", "unique_customers", "valid_from", "valid_to" FROM "inserted_rows" (base.py:2622)
2025-12-03 04:57:59,068 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,072 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__scd_type2_by_column_py__3946204845' (evaluator.py:984)
2025-12-03 04:57:59,076 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE "total_transactions" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,077 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column__1318279303_57lg6yil" (base.py:2622)
2025-12-03 04:57:59,078 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column_py__3946204845') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,079 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time": 96374401> (evaluator.py:711)
2025-12-03 04:57:59,081 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,088 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column": 3563531193> (evaluator.py:603)
2025-12-03 04:57:59,102 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time": 96374401> (evaluator.py:952)
2025-12-03 04:57:59,105 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:59,107 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,117 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE "unique_customers" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,118 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__scd_type2_by_time__324217294' (evaluator.py:984)
2025-12-03 04:57:59,125 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE ("product_id" IS NULL OR "product_name" IS NULL OR "category" IS NULL) AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,126 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,128 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column_py__3946204845" ("product_id" INT, "product_name" TEXT, "category" TEXT, "price" DECIMAL(10, 2), "valid_from" TIMESTAMP, "valid_to" TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,129 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__partition__344634559') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,131 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,133 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "vulcan__vulcan_demo" (base.py:2622)
2025-12-03 04:57:59,137 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__partition__344634559" AS "vulcan_demo__partition__344634559" WHERE "avg_order_value" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,140 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE "product_name" = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,141 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column_py__3946204845_ae7c6jou" AS SELECT CAST("product_id" AS INT) AS "product_id", CAST("product_name" AS TEXT) AS "product_name", CAST("category" AS TEXT) AS "category", CAST("price" AS DECIMAL(10, 2)) AS "price", CAST("valid_from" AS TIMESTAMP) AS "valid_from", CAST("valid_to" AS TIMESTAMP) AS "valid_to" FROM (SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to" FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column_py__3946204845") AS "_subquery" (base.py:2622)
2025-12-03 04:57:59,144 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,145 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition": 904715744> (facade.py:726)
2025-12-03 04:57:59,148 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE "category" = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,151 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column_py__3946204845" WHERE TRUE (base.py:2622)
2025-12-03 04:57:59,151 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."partition": 904715744> (interval.py:215)
2025-12-03 04:57:59,168 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:59,170 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,182 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column_py__3946204845" ("product_id", "product_name", "category", "price", "valid_from", "valid_to") WITH "source" AS (SELECT DISTINCT ON ("product_id") TRUE AS "_exists", "product_id", "product_name", "category", "price" FROM (SELECT CAST("product_id" AS INT) AS "product_id", CAST("product_name" AS TEXT) AS "product_name", CAST("category" AS TEXT) AS "category", CAST("price" AS DECIMAL(10, 2)) AS "price" FROM (VALUES "<REDACTED VALUES>") AS "t"("product_id", "product_name", "category", "price")) AS "raw_source"), "static" AS (SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column_py__3946204845_ae7c6jou" WHERE NOT "valid_to" IS NULL), "latest" AS (SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column_py__3946204845_ae7c6jou" WHERE "valid_to" IS NULL), "deleted" AS (SELECT "static"."product_id", "static"."product_name", "static"."category", "static"."price", "static"."valid_from", "static"."valid_to" FROM "static" LEFT JOIN "latest" ON "static"."product_id" = "latest"."product_id" WHERE "latest"."valid_to" IS NULL), "latest_deleted" AS (SELECT TRUE AS "_exists", "product_id" AS "_key0", MAX("valid_to") AS "valid_to" FROM "deleted" GROUP BY "product_id"), "joined" AS (SELECT "source"."_exists" AS "_exists", "latest"."product_id" AS "t_product_id", "latest"."product_name" AS "t_product_name", "latest"."category" AS "t_category", "latest"."price" AS "t_price", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."product_id" AS "product_id", "source"."product_name" AS "product_name", "source"."category" AS "category", "source"."price" AS "price" FROM "latest" LEFT JOIN "source" ON "latest"."product_id" = "source"."product_id" UNION ALL SELECT "source"."_exists" AS "_exists", "latest"."product_id" AS "t_product_id", "latest"."product_name" AS "t_product_name", "latest"."category" AS "t_category", "latest"."price" AS "t_price", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."product_id" AS "product_id", "source"."product_name" AS "product_name", "source"."category" AS "category", "source"."price" AS "price" FROM "latest" RIGHT JOIN "source" ON "latest"."product_id" = "source"."product_id" WHERE "latest"."_exists" IS NULL), "updated_rows" AS (SELECT COALESCE("joined"."t_product_id", "joined"."product_id") AS "product_id", COALESCE("joined"."t_product_name", "joined"."product_name") AS "product_name", COALESCE("joined"."t_category", "joined"."category") AS "category", COALESCE("joined"."t_price", "joined"."price") AS "price", COALESCE("t_valid_from", CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP)) AS "valid_from", CASE WHEN (NOT "joined"."t_product_id" IS NULL AND NOT "joined"."product_id" IS NULL) AND ("joined"."product_name" <> "joined"."t_product_name" OR ("joined"."t_product_name" IS NULL AND NOT "joined"."product_name" IS NULL) OR (NOT "joined"."t_product_name" IS NULL AND "joined"."product_name" IS NULL) OR "joined"."category" <> "joined"."t_category" OR ("joined"."t_category" IS NULL AND NOT "joined"."category" IS NULL) OR (NOT "joined"."t_category" IS NULL AND "joined"."category" IS NULL) OR "joined"."price" <> "joined"."t_price" OR ("joined"."t_price" IS NULL AND NOT "joined"."price" IS NULL) OR (NOT "joined"."t_price" IS NULL AND "joined"."price" IS NULL)) THEN CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP) ELSE "t_valid_to" END AS "valid_to" FROM "joined" LEFT JOIN "latest_deleted" ON "joined"."product_id" = "latest_deleted"."_key0"), "inserted_rows" AS (SELECT "product_id", "product_name", "category", "price", CAST('2025-12-03 04:57:58.399000' AS TIMESTAMP) AS "valid_from", CAST(NULL AS TIMESTAMP) AS "valid_to" FROM "joined" WHERE (NOT "joined"."t_product_id" IS NULL AND NOT "joined"."product_id" IS NULL) AND ("joined"."product_name" <> "joined"."t_product_name" OR ("joined"."t_product_name" IS NULL AND NOT "joined"."product_name" IS NULL) OR (NOT "joined"."t_product_name" IS NULL AND "joined"."product_name" IS NULL) OR "joined"."category" <> "joined"."t_category" OR ("joined"."t_category" IS NULL AND NOT "joined"."category" IS NULL) OR (NOT "joined"."t_category" IS NULL AND "joined"."category" IS NULL) OR "joined"."price" <> "joined"."t_price" OR ("joined"."t_price" IS NULL AND NOT "joined"."price" IS NULL) OR (NOT "joined"."t_price" IS NULL AND "joined"."price" IS NULL))) SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to" FROM "static" UNION ALL SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to" FROM "updated_rows" UNION ALL SELECT "product_id", "product_name", "category", "price", "valid_from", "valid_to" FROM "inserted_rows" (base.py:2622)
2025-12-03 04:57:59,187 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" ("dt" DATE, "year" INT, "month" INT, "day_of_week" TEXT, "total_transactions" BIGINT, "total_quantity_sold" BIGINT, "total_sales_amount" DECIMAL, "avg_unit_price" DOUBLE PRECISION, "unique_customers" BIGINT, "unique_products" BIGINT, "unique_warehouses" BIGINT, "updated_at" TIMESTAMP, "valid_from" TIMESTAMP, "valid_to" TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,192 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE "price" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,192 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."dt" IS 'Date' (base.py:2622)
2025-12-03 04:57:59,193 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."year" IS 'Year' (base.py:2622)
2025-12-03 04:57:59,194 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time_py": 2700266354> (evaluator.py:711)
2025-12-03 04:57:59,195 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_column_py__3946204845_ae7c6jou" (base.py:2622)
2025-12-03 04:57:59,195 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."month" IS 'Month' (base.py:2622)
2025-12-03 04:57:59,195 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time_py": 2700266354> (evaluator.py:952)
2025-12-03 04:57:59,197 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,197 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."day_of_week" IS 'Day of Week' (base.py:2622)
2025-12-03 04:57:59,199 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__scd_type2_by_time_py__308562760' (evaluator.py:984)
2025-12-03 04:57:59,200 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."total_transactions" IS 'Total Transactions' (base.py:2622)
2025-12-03 04:57:59,201 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time_py__308562760') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,206 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE "total_orders" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,206 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column_py": 846708042> (facade.py:726)
2025-12-03 04:57:59,206 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column_py": 846708042> (interval.py:215)
2025-12-03 04:57:59,206 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."total_quantity_sold" IS 'Total Quantity Sold' (base.py:2622)
2025-12-03 04:57:59,216 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_column__1318279303') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,229 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:59,229 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."total_sales_amount" IS 'Total Sales Amount' (base.py:2622)
2025-12-03 04:57:59,236 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_column__1318279303" AS "vulcan_demo__scd_type2_by_column__1318279303" WHERE "total_quantity_sold" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,238 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."unique_customers" IS 'Unique Customers' (base.py:2622)
2025-12-03 04:57:59,238 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."unique_products" IS 'Unique Products' (base.py:2622)
2025-12-03 04:57:59,239 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column": 3563531193> (facade.py:726)
2025-12-03 04:57:59,240 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_customers": 4039897219> (evaluator.py:711)
2025-12-03 04:57:59,241 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time_py__308562760" ("customer_id" INT, "customer_name" TEXT, "email" TEXT, "region_name" TEXT, "valid_from" TIMESTAMP, "valid_to" TIMESTAMP, "updated_at" TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,241 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: COMMENT ON COLUMN "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294"."unique_warehouses" IS 'Unique Warehouses' (base.py:2622)
2025-12-03 04:57:59,241 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_column": 3563531193> (interval.py:215)
2025-12-03 04:57:59,242 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_customers": 4039897219> (evaluator.py:952)
2025-12-03 04:57:59,242 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "vulcan__vulcan_demo" (base.py:2622)
2025-12-03 04:57:59,245 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "vulcan__vulcan_demo" (base.py:2622)
2025-12-03 04:57:59,262 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__stg_customers__2075250225' (evaluator.py:984)
2025-12-03 04:57:59,263 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time_py__308562760_f2uefh6x" AS SELECT CAST("customer_id" AS INT) AS "customer_id", CAST("customer_name" AS TEXT) AS "customer_name", CAST("email" AS TEXT) AS "email", CAST("region_name" AS TEXT) AS "region_name", CAST("valid_from" AS TIMESTAMP) AS "valid_from", CAST("valid_to" AS TIMESTAMP) AS "valid_to", CAST("updated_at" AS TIMESTAMP) AS "updated_at" FROM (SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at" FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time_py__308562760") AS "_subquery" (base.py:2622)
2025-12-03 04:57:59,264 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time__324217294_2jfr5ekd" AS SELECT CAST("dt" AS DATE) AS "dt", CAST("year" AS INT) AS "year", CAST("month" AS INT) AS "month", CAST("day_of_week" AS TEXT) AS "day_of_week", CAST("total_transactions" AS BIGINT) AS "total_transactions", CAST("total_quantity_sold" AS BIGINT) AS "total_quantity_sold", CAST("total_sales_amount" AS DECIMAL) AS "total_sales_amount", CAST("avg_unit_price" AS DOUBLE PRECISION) AS "avg_unit_price", CAST("unique_customers" AS BIGINT) AS "unique_customers", CAST("unique_products" AS BIGINT) AS "unique_products", CAST("unique_warehouses" AS BIGINT) AS "unique_warehouses", CAST("updated_at" AS TIMESTAMP) AS "updated_at", CAST("valid_from" AS TIMESTAMP) AS "valid_from", CAST("valid_to" AS TIMESTAMP) AS "valid_to" FROM (SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to" FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294") AS "_subquery" (base.py:2622)
2025-12-03 04:57:59,265 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__stg_customers__2075250225' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,266 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_order_lines": 945780940> (evaluator.py:711)
2025-12-03 04:57:59,267 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_order_lines": 945780940> (evaluator.py:952)
2025-12-03 04:57:59,267 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__stg_customers__2075250225' (evaluator.py:2659)
2025-12-03 04:57:59,276 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time_py__308562760" WHERE TRUE (base.py:2622)
2025-12-03 04:57:59,285 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" WHERE TRUE (base.py:2622)
2025-12-03 04:57:59,287 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__stg_order_lines__917252049' (evaluator.py:984)
2025-12-03 04:57:59,287 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_customers": 4039897219> (facade.py:726)
2025-12-03 04:57:59,289 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__stg_order_lines__917252049') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,374 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time_py__308562760" ("customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at") WITH "source" AS (SELECT DISTINCT ON ("customer_id") TRUE AS "_exists", "customer_id", "customer_name", "email", "region_name", CAST("updated_at" AS TIMESTAMP) AS "updated_at" FROM (SELECT CAST("customer_id" AS INT) AS "customer_id", CAST("customer_name" AS TEXT) AS "customer_name", CAST("email" AS TEXT) AS "email", CAST("region_name" AS TEXT) AS "region_name", CAST("updated_at" AS TIMESTAMP) AS "updated_at" FROM (VALUES "<REDACTED VALUES>") AS "t"("customer_id", "customer_name", "email", "region_name", "updated_at")) AS "raw_source"), "static" AS (SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time_py__308562760_f2uefh6x" WHERE NOT "valid_to" IS NULL), "latest" AS (SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time_py__308562760_f2uefh6x" WHERE "valid_to" IS NULL), "deleted" AS (SELECT "static"."customer_id", "static"."customer_name", "static"."email", "static"."region_name", "static"."valid_from", "static"."valid_to", "static"."updated_at" FROM "static" LEFT JOIN "latest" ON "static"."customer_id" = "latest"."customer_id" WHERE "latest"."valid_to" IS NULL), "latest_deleted" AS (SELECT TRUE AS "_exists", "customer_id" AS "_key0", MAX("valid_to") AS "valid_to" FROM "deleted" GROUP BY "customer_id"), "joined" AS (SELECT "source"."_exists" AS "_exists", "latest"."customer_id" AS "t_customer_id", "latest"."customer_name" AS "t_customer_name", "latest"."email" AS "t_email", "latest"."region_name" AS "t_region_name", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "latest"."updated_at" AS "t_updated_at", "source"."customer_id" AS "customer_id", "source"."customer_name" AS "customer_name", "source"."email" AS "email", "source"."region_name" AS "region_name", "source"."updated_at" AS "updated_at" FROM "latest" LEFT JOIN "source" ON "latest"."customer_id" = "source"."customer_id" UNION ALL SELECT "source"."_exists" AS "_exists", "latest"."customer_id" AS "t_customer_id", "latest"."customer_name" AS "t_customer_name", "latest"."email" AS "t_email", "latest"."region_name" AS "t_region_name", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "latest"."updated_at" AS "t_updated_at", "source"."customer_id" AS "customer_id", "source"."customer_name" AS "customer_name", "source"."email" AS "email", "source"."region_name" AS "region_name", "source"."updated_at" AS "updated_at" FROM "latest" RIGHT JOIN "source" ON "latest"."customer_id" = "source"."customer_id" WHERE "latest"."_exists" IS NULL), "updated_rows" AS (SELECT COALESCE("joined"."t_customer_id", "joined"."customer_id") AS "customer_id", COALESCE("joined"."t_customer_name", "joined"."customer_name") AS "customer_name", COALESCE("joined"."t_email", "joined"."email") AS "email", COALESCE("joined"."t_region_name", "joined"."region_name") AS "region_name", COALESCE("joined"."t_updated_at", "joined"."updated_at") AS "updated_at", CASE WHEN "t_valid_from" IS NULL AND NOT "latest_deleted"."_exists" IS NULL THEN CASE WHEN "latest_deleted"."valid_to" > "updated_at" THEN "latest_deleted"."valid_to" ELSE "updated_at" END WHEN "t_valid_from" IS NULL THEN CAST('1970-01-01 00:00:00' AS TIMESTAMP) ELSE "t_valid_from" END AS "valid_from", CASE WHEN "joined"."updated_at" > "joined"."t_updated_at" THEN "joined"."updated_at" ELSE "t_valid_to" END AS "valid_to" FROM "joined" LEFT JOIN "latest_deleted" ON "joined"."customer_id" = "latest_deleted"."_key0"), "inserted_rows" AS (SELECT "customer_id", "customer_name", "email", "region_name", "updated_at", "updated_at" AS "valid_from", CAST(NULL AS TIMESTAMP) AS "valid_to" FROM "joined" WHERE "joined"."updated_at" > "joined"."t_updated_at") SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at" FROM "static" UNION ALL SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at" FROM "updated_rows" UNION ALL SELECT "customer_id", "customer_name", "email", "region_name", "valid_from", "valid_to", "updated_at" FROM "inserted_rows" (base.py:2622)
2025-12-03 04:57:59,379 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" ("dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to") WITH "source" AS (SELECT DISTINCT ON ("dt") TRUE AS "_exists", "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", CAST("updated_at" AS TIMESTAMP) AS "updated_at" FROM (SELECT "dd"."dt" AS "dt", "dd"."year" AS "year", "dd"."month" AS "month", "dd"."day_of_week" AS "day_of_week", COUNT(DISTINCT "o"."order_id") + 10000 AS "total_transactions", SUM("oi"."quantity") AS "total_quantity_sold", SUM("oi"."quantity" * "oi"."unit_price") AS "total_sales_amount", AVG("oi"."unit_price") AS "avg_unit_price", COUNT(DISTINCT "o"."customer_id") AS "unique_customers", COUNT(DISTINCT "oi"."product_id") AS "unique_products", COUNT(DISTINCT "o"."warehouse_id") AS "unique_warehouses", CURRENT_TIMESTAMP AS "updated_at" FROM "warehouse"."vulcan_demo"."dim_dates" AS "dd" LEFT JOIN "warehouse"."vulcan_demo"."orders" AS "o" ON "dd"."dt" = "o"."order_date" LEFT JOIN "warehouse"."vulcan_demo"."order_items" AS "oi" ON "o"."order_id" = "oi"."order_id" GROUP BY "dd"."dt", "dd"."year", "dd"."month", "dd"."day_of_week" ORDER BY "dt") AS "raw_source"), "static" AS (SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time__324217294_2jfr5ekd" WHERE NOT "valid_to" IS NULL), "latest" AS (SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to", TRUE AS "_exists" FROM "warehouse"."vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time__324217294_2jfr5ekd" WHERE "valid_to" IS NULL), "deleted" AS (SELECT "static"."dt", "static"."year", "static"."month", "static"."day_of_week", "static"."total_transactions", "static"."total_quantity_sold", "static"."total_sales_amount", "static"."avg_unit_price", "static"."unique_customers", "static"."unique_products", "static"."unique_warehouses", "static"."updated_at", "static"."valid_from", "static"."valid_to" FROM "static" LEFT JOIN "latest" ON "static"."dt" = "latest"."dt" WHERE "latest"."valid_to" IS NULL), "latest_deleted" AS (SELECT TRUE AS "_exists", "dt" AS "_key0", MAX("valid_to") AS "valid_to" FROM "deleted" GROUP BY "dt"), "joined" AS (SELECT "source"."_exists" AS "_exists", "latest"."dt" AS "t_dt", "latest"."year" AS "t_year", "latest"."month" AS "t_month", "latest"."day_of_week" AS "t_day_of_week", "latest"."total_transactions" AS "t_total_transactions", "latest"."total_quantity_sold" AS "t_total_quantity_sold", "latest"."total_sales_amount" AS "t_total_sales_amount", "latest"."avg_unit_price" AS "t_avg_unit_price", "latest"."unique_customers" AS "t_unique_customers", "latest"."unique_products" AS "t_unique_products", "latest"."unique_warehouses" AS "t_unique_warehouses", "latest"."updated_at" AS "t_updated_at", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."dt" AS "dt", "source"."year" AS "year", "source"."month" AS "month", "source"."day_of_week" AS "day_of_week", "source"."total_transactions" AS "total_transactions", "source"."total_quantity_sold" AS "total_quantity_sold", "source"."total_sales_amount" AS "total_sales_amount", "source"."avg_unit_price" AS "avg_unit_price", "source"."unique_customers" AS "unique_customers", "source"."unique_products" AS "unique_products", "source"."unique_warehouses" AS "unique_warehouses", "source"."updated_at" AS "updated_at" FROM "latest" LEFT JOIN "source" ON "latest"."dt" = "source"."dt" UNION ALL SELECT "source"."_exists" AS "_exists", "latest"."dt" AS "t_dt", "latest"."year" AS "t_year", "latest"."month" AS "t_month", "latest"."day_of_week" AS "t_day_of_week", "latest"."total_transactions" AS "t_total_transactions", "latest"."total_quantity_sold" AS "t_total_quantity_sold", "latest"."total_sales_amount" AS "t_total_sales_amount", "latest"."avg_unit_price" AS "t_avg_unit_price", "latest"."unique_customers" AS "t_unique_customers", "latest"."unique_products" AS "t_unique_products", "latest"."unique_warehouses" AS "t_unique_warehouses", "latest"."updated_at" AS "t_updated_at", "latest"."valid_from" AS "t_valid_from", "latest"."valid_to" AS "t_valid_to", "source"."dt" AS "dt", "source"."year" AS "year", "source"."month" AS "month", "source"."day_of_week" AS "day_of_week", "source"."total_transactions" AS "total_transactions", "source"."total_quantity_sold" AS "total_quantity_sold", "source"."total_sales_amount" AS "total_sales_amount", "source"."avg_unit_price" AS "avg_unit_price", "source"."unique_customers" AS "unique_customers", "source"."unique_products" AS "unique_products", "source"."unique_warehouses" AS "unique_warehouses", "source"."updated_at" AS "updated_at" FROM "latest" RIGHT JOIN "source" ON "latest"."dt" = "source"."dt" WHERE "latest"."_exists" IS NULL), "updated_rows" AS (SELECT COALESCE("joined"."t_dt", "joined"."dt") AS "dt", COALESCE("joined"."t_year", "joined"."year") AS "year", COALESCE("joined"."t_month", "joined"."month") AS "month", COALESCE("joined"."t_day_of_week", "joined"."day_of_week") AS "day_of_week", COALESCE("joined"."t_total_transactions", "joined"."total_transactions") AS "total_transactions", COALESCE("joined"."t_total_quantity_sold", "joined"."total_quantity_sold") AS "total_quantity_sold", COALESCE("joined"."t_total_sales_amount", "joined"."total_sales_amount") AS "total_sales_amount", COALESCE("joined"."t_avg_unit_price", "joined"."avg_unit_price") AS "avg_unit_price", COALESCE("joined"."t_unique_customers", "joined"."unique_customers") AS "unique_customers", COALESCE("joined"."t_unique_products", "joined"."unique_products") AS "unique_products", COALESCE("joined"."t_unique_warehouses", "joined"."unique_warehouses") AS "unique_warehouses", COALESCE("joined"."t_updated_at", "joined"."updated_at") AS "updated_at", CASE WHEN "t_valid_from" IS NULL AND NOT "latest_deleted"."_exists" IS NULL THEN CASE WHEN "latest_deleted"."valid_to" > "updated_at" THEN "latest_deleted"."valid_to" ELSE "updated_at" END WHEN "t_valid_from" IS NULL THEN CAST('1970-01-01 00:00:00' AS TIMESTAMP) ELSE "t_valid_from" END AS "valid_from", CASE WHEN "joined"."updated_at" > "joined"."t_updated_at" THEN "joined"."updated_at" ELSE "t_valid_to" END AS "valid_to" FROM "joined" LEFT JOIN "latest_deleted" ON "joined"."dt" = "latest_deleted"."_key0"), "inserted_rows" AS (SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "updated_at" AS "valid_from", CAST(NULL AS TIMESTAMP) AS "valid_to" FROM "joined" WHERE "joined"."updated_at" > "joined"."t_updated_at") SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to" FROM "static" UNION ALL SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to" FROM "updated_rows" UNION ALL SELECT "dt", "year", "month", "day_of_week", "total_transactions", "total_quantity_sold", "total_sales_amount", "avg_unit_price", "unique_customers", "unique_products", "unique_warehouses", "updated_at", "valid_from", "valid_to" FROM "inserted_rows" (base.py:2622)
2025-12-03 04:57:59,379 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_customers": 4039897219> (interval.py:215)
2025-12-03 04:57:59,385 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__stg_order_lines__917252049" WHERE "order_date" BETWEEN CAST('2025-12-03 04:45:00' AS TIMESTAMP) AND CAST('2025-12-03 04:54:59.999999' AS TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,385 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time_py__308562760_f2uefh6x" (base.py:2622)
2025-12-03 04:57:59,386 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "vulcan__vulcan_demo"."__temp_vulcan_demo__scd_type2_by_time__324217294_2jfr5ekd" (base.py:2622)
2025-12-03 04:57:59,391 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__stg_order_lines__917252049" ("order_item_sk", "order_id", "item_id", "product_id", "quantity", "unit_price", "line_revenue", "customer_id", "order_date", "warehouse_id", "warehouse_id_filter") WITH "base" AS (SELECT "oi"."order_id" AS "order_id", "oi"."item_id" AS "item_id", "oi"."product_id" AS "product_id", CAST("oi"."quantity" AS INT) AS "quantity", CAST("oi"."unit_price" AS DECIMAL(10, 2)) AS "unit_price", CAST("oi"."quantity" * "oi"."unit_price" AS DECIMAL(18, 2)) AS "line_revenue", "o"."customer_id" AS "customer_id", CAST("o"."order_date" AS TIMESTAMP) AS "order_date", "o"."warehouse_id" AS "warehouse_id", "o"."warehouse_id" AS "warehouse_id_filter" FROM "warehouse"."vulcan_demo"."order_items" AS "oi" LEFT JOIN "warehouse"."vulcan_demo"."orders" AS "o" ON "o"."order_id" = "oi"."order_id" WHERE "o"."order_date" <= CAST('2025-12-03' AS DATE) AND "o"."order_date" >= CAST('2025-12-03' AS DATE)) SELECT "order_item_sk", "order_id", "item_id", "product_id", "quantity", "unit_price", "line_revenue", "customer_id", "order_date", "warehouse_id", "warehouse_id_filter" FROM (SELECT MD5(CONCAT(COALESCE(CAST("base"."order_id" AS TEXT), '_vulcan_surrogate_key_null_'), '|', COALESCE(CAST("base"."item_id" AS TEXT), '_vulcan_surrogate_key_null_'))) AS "order_item_sk", "base"."order_id" AS "order_id", "base"."item_id" AS "item_id", "base"."product_id" AS "product_id", "base"."quantity" AS "quantity", "base"."unit_price" AS "unit_price", "base"."line_revenue" AS "line_revenue", "base"."customer_id" AS "customer_id", CAST("base"."order_date" AS TIMESTAMP) AS "order_date", "base"."warehouse_id" AS "warehouse_id", "base"."warehouse_id_filter" AS "warehouse_id_filter" FROM "base" AS "base") AS "_subquery" WHERE "order_date" BETWEEN CAST('2025-12-03 04:45:00' AS TIMESTAMP) AND CAST('2025-12-03 04:54:59.999999' AS TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,392 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time": 96374401> (evaluator.py:603)
2025-12-03 04:57:59,392 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time_py": 2700266354> (facade.py:726)
2025-12-03 04:57:59,395 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_products": 3206430371> (evaluator.py:711)
2025-12-03 04:57:59,397 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,397 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time_py": 2700266354> (interval.py:215)
2025-12-03 04:57:59,397 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_products": 3206430371> (evaluator.py:952)
2025-12-03 04:57:59,397 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_order_lines": 945780940> (facade.py:726)
2025-12-03 04:57:59,413 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__stg_products__1194216587' (evaluator.py:984)
2025-12-03 04:57:59,413 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_order_lines": 945780940> (interval.py:215)
2025-12-03 04:57:59,417 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE ("dt" IS NULL OR "year" IS NULL OR "month" IS NULL OR "day_of_week" IS NULL) AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,419 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__stg_products__1194216587' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,423 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."view_model": 2016917419> (evaluator.py:711)
2025-12-03 04:57:59,424 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__stg_products__1194216587' (evaluator.py:2659)
2025-12-03 04:57:59,424 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."view_model": 2016917419> (evaluator.py:952)
2025-12-03 04:57:59,426 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,434 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_products": 3206430371> (facade.py:726)
2025-12-03 04:57:59,443 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__view_model__938266766' (evaluator.py:984)
2025-12-03 04:57:59,444 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."stg_products": 3206430371> (interval.py:215)
2025-12-03 04:57:59,447 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE ("day_of_week") = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,448 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__view_model__938266766' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,449 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."dim_customer": 2359068865> (evaluator.py:711)
2025-12-03 04:57:59,451 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."dim_customer": 2359068865> (evaluator.py:952)
2025-12-03 04:57:59,454 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__view_model__938266766' (evaluator.py:2659)
2025-12-03 04:57:59,458 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:50:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__dim_customer__3881191677' (evaluator.py:984)
2025-12-03 04:57:59,459 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,460 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2622)
2025-12-03 04:57:59,460 - ThreadPoolExecutor-1_3 - vulcan.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"warehouse"."vulcan_demo"."view_model": 2016917419> (evaluator.py:603)
2025-12-03 04:57:59,462 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,468 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "total_transactions" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,469 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__dim_customer__3881191677" WHERE TRUE (base.py:2622)
2025-12-03 04:57:59,473 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT ROW_NUMBER() OVER (PARTITION BY "warehouse_performance_key" ORDER BY "warehouse_performance_key" NULLS FIRST) AS "rank_warehouse_performance_key" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE TRUE) AS "_q_0" WHERE "rank_warehouse_performance_key" > 1) AS "audit" (base.py:2622)
2025-12-03 04:57:59,475 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,475 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__dim_customer__3881191677" ("customer_sk", "customer_id", "customer_name", "email", "region_id", "region_name") SELECT CAST("sc"."customer_sk" AS TEXT) AS "customer_sk", CAST("sc"."customer_id" AS INT) AS "customer_id", CAST("sc"."customer_name" AS TEXT) AS "customer_name", CAST("sc"."email" AS TEXT) AS "email", CAST("sc"."region_id" AS INT) AS "region_id", CAST("sc"."region_name" AS TEXT) AS "region_name" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_customers__2075250225" AS "sc" (base.py:2622)
2025-12-03 04:57:59,480 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "total_quantity_sold" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,483 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,484 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."dim_customer": 2359068865> (facade.py:726)
2025-12-03 04:57:59,484 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."dim_customer": 2359068865> (interval.py:215)
2025-12-03 04:57:59,485 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,489 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE ("warehouse_id" IS NULL OR "warehouse_name" IS NULL OR "order_date" IS NULL OR "warehouse_performance_key" IS NULL) AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,516 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,520 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "total_sales_amount" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,528 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE ("warehouse_name") = '' AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,531 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,533 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales": 3567707351> (evaluator.py:711)
2025-12-03 04:57:59,535 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,536 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales": 3567707351> (evaluator.py:952)
2025-12-03 04:57:59,541 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "unique_customers" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,578 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "total_transactions" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,580 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,615 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,622 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__3137287359' (evaluator.py:984)
2025-12-03 04:57:59,628 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "vulcan__vulcan_demo"."vulcan_demo__fct_daily_sales__3137287359" WHERE "sales_date" BETWEEN CAST('2025-12-03 04:45:00' AS TIMESTAMP) AND CAST('2025-12-03 04:54:59.999999' AS TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,663 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "unique_products" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,665 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "total_quantity_sold" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,669 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__vulcan_demo"."vulcan_demo__fct_daily_sales__3137287359" ("sales_date", "customer_sk", "product_sk", "region_id", "region_name", "category", "category_bucket", "units", "revenue", "avg_selling_price") WITH "spine" AS (SELECT CAST("dd"."dt" AS DATE) AS "sales_date" FROM "warehouse"."vulcan_demo"."dim_dates" AS "dd" WHERE "dd"."dt" <= CAST('2025-12-03' AS DATE) AND "dd"."dt" >= CAST('2025-12-03' AS DATE)), "line_agg" AS (SELECT CAST("sol"."order_date" AS TIMESTAMP) AS "sales_date", MD5(CONCAT(COALESCE(CAST("sol"."customer_id" AS TEXT), '_vulcan_surrogate_key_null_'), '|', COALESCE(CAST("sc"."email" AS TEXT), '_vulcan_surrogate_key_null_'))) AS "customer_sk", "sp"."product_sk" AS "product_sk", CAST(SUM("sol"."quantity") AS INT) AS "units", CAST(SUM("sol"."line_revenue") AS DECIMAL(18, 2)) AS "revenue", CASE WHEN COALESCE(SUM("sol"."quantity"), 0) = 0 THEN 0.0 ELSE CAST(CAST(COALESCE(SUM("sol"."line_revenue"), 0) AS DOUBLE PRECISION) / COALESCE(SUM("sol"."quantity"), 0) AS DOUBLE PRECISION) END AS "avg_selling_price" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_order_lines__917252049" AS "sol" JOIN "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_customers__2075250225" AS "sc" ON "sc"."customer_id" = "sol"."customer_id" JOIN "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_products__1194216587" AS "sp" ON "sol"."item_id" = "sp"."product_id" WHERE "sol"."order_date" <= CAST('2025-12-03' AS DATE) AND "sol"."order_date" >= CAST('2025-12-03' AS DATE) GROUP BY "sol"."order_date", "sol"."customer_id", "sc"."email", "sp"."product_sk"), "cat_rank" AS (SELECT "sp"."category" AS "category", DENSE_RANK() OVER (ORDER BY SUM("sol"."line_revenue") DESC) AS "rnk" FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_order_lines__917252049" AS "sol" JOIN "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_products__1194216587" AS "sp" ON "sol"."item_id" = "sp"."product_id" WHERE "sol"."order_date" <= CAST('2025-12-03' AS DATE) AND "sol"."order_date" >= CAST('2025-12-03' AS DATE) GROUP BY "sp"."category"), "joined" AS (SELECT CAST("la"."sales_date" AS TIMESTAMP) AS "sales_date", "la"."customer_sk" AS "customer_sk", "la"."product_sk" AS "product_sk", "dc"."region_id" AS "region_id", "dc"."region_name" AS "region_name", "sp"."category" AS "category", "la"."units" AS "units", "la"."revenue" AS "revenue", "la"."avg_selling_price" AS "avg_selling_price", CASE WHEN "sp"."category" IN ((SELECT "category" FROM "cat_rank" WHERE "rnk" <= 5)) THEN "sp"."category" ELSE 'Other' END AS "category_bucket" FROM "line_agg" AS "la" LEFT JOIN "warehouse"."vulcan__vulcan_demo"."vulcan_demo__dim_customer__3881191677" AS "dc" ON "dc"."customer_sk" = "la"."customer_sk" LEFT JOIN "warehouse"."vulcan__vulcan_demo"."vulcan_demo__stg_products__1194216587" AS "sp" ON "la"."product_sk" = "sp"."product_sk") SELECT "sales_date", "customer_sk", "product_sk", "region_id", "region_name", "category", "category_bucket", "units", "revenue", "avg_selling_price" FROM (SELECT CAST("s"."sales_date" AS TIMESTAMP) AS "sales_date", CAST("j"."customer_sk" AS TEXT) AS "customer_sk", CAST("j"."product_sk" AS TEXT) AS "product_sk", CAST("j"."region_id" AS INT) AS "region_id", CAST("j"."region_name" AS TEXT) AS "region_name", CAST("j"."category" AS TEXT) AS "category", CAST("j"."category_bucket" AS TEXT) AS "category_bucket", CAST("j"."units" AS INT) AS "units", CAST("j"."revenue" AS DECIMAL(18, 4)) AS "revenue", CAST("j"."avg_selling_price" AS DOUBLE PRECISION) AS "avg_selling_price" FROM "spine" AS "s" LEFT JOIN "joined" AS "j" ON "j"."sales_date" = "s"."sales_date" WHERE "s"."sales_date" <= CAST('2025-12-03' AS DATE) AND "s"."sales_date" >= CAST('2025-12-03' AS DATE)) AS "_subquery" WHERE "sales_date" BETWEEN CAST('2025-12-03 04:45:00' AS TIMESTAMP) AND CAST('2025-12-03 04:54:59.999999' AS TIMESTAMP) (base.py:2622)
2025-12-03 04:57:59,675 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__scd_type2_by_time__324217294') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,678 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,684 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__scd_type2_by_time__324217294" AS "vulcan_demo__scd_type2_by_time__324217294" WHERE "unique_warehouses" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,684 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales": 3567707351> (facade.py:726)
2025-12-03 04:57:59,692 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "total_sales_amount" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,692 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales": 3567707351> (interval.py:215)
2025-12-03 04:57:59,693 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:50:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time": 96374401> (facade.py:726)
2025-12-03 04:57:59,695 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."scd_type2_by_time": 96374401> (interval.py:215)
2025-12-03 04:57:59,703 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,712 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "unique_customers" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,714 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__east": 1444848944> (evaluator.py:711)
2025-12-03 04:57:59,715 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__east": 1444848944> (evaluator.py:952)
2025-12-03 04:57:59,716 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__north": 3623134160> (evaluator.py:711)
2025-12-03 04:57:59,725 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__north": 3623134160> (evaluator.py:952)
2025-12-03 04:57:59,721 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__east__468749772' (evaluator.py:984)
2025-12-03 04:57:59,725 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,717 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__south": 2877365043> (evaluator.py:711)
2025-12-03 04:57:59,729 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__north__2281312756' (evaluator.py:984)
2025-12-03 04:57:59,730 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__fct_daily_sales__east__468749772' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,730 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__south": 2877365043> (evaluator.py:952)
2025-12-03 04:57:59,731 - ThreadPoolExecutor-1_2 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__fct_daily_sales__north__2281312756' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,736 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "avg_order_value" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,740 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__south__3800341134' (evaluator.py:984)
2025-12-03 04:57:59,740 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__east__468749772' (evaluator.py:2659)
2025-12-03 04:57:59,741 - ThreadPoolExecutor-1_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__fct_daily_sales__south__3800341134' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,741 - ThreadPoolExecutor-1_2 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__north__2281312756' (evaluator.py:2659)
2025-12-03 04:57:59,741 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__east": 1444848944> (facade.py:726)
2025-12-03 04:57:59,742 - ThreadPoolExecutor-1_0 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__south__3800341134' (evaluator.py:2659)
2025-12-03 04:57:59,742 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__east": 1444848944> (interval.py:215)
2025-12-03 04:57:59,742 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__north": 3623134160> (facade.py:726)
2025-12-03 04:57:59,745 - ThreadPoolExecutor-1_2 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__north": 3623134160> (interval.py:215)
2025-12-03 04:57:59,745 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__south": 2877365043> (facade.py:726)
2025-12-03 04:57:59,750 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,750 - ThreadPoolExecutor-1_0 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__south": 2877365043> (interval.py:215)
2025-12-03 04:57:59,761 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE "revenue_per_customer" < 0 AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,763 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__west": 3696317990> (evaluator.py:711)
2025-12-03 04:57:59,764 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__west": 3696317990> (evaluator.py:952)
2025-12-03 04:57:59,768 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2025-12-03 04:45:00, 2025-12-03 04:55:00) into warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__west__2779206998' (evaluator.py:984)
2025-12-03 04:57:59,769 - ThreadPoolExecutor-1_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'vulcan_demo__fct_daily_sales__west__2779206998' AND "table_schema" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,770 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'vulcan_demo__view_model__938266766') AND "nspname" = 'vulcan__vulcan_demo' (base.py:2622)
2025-12-03 04:57:59,771 - ThreadPoolExecutor-1_1 - vulcan.core.snapshot.evaluator - INFO - Skipping creation of the view 'warehouse.vulcan__vulcan_demo.vulcan_demo__fct_daily_sales__west__2779206998' (evaluator.py:2659)
2025-12-03 04:57:59,774 - ThreadPoolExecutor-1_3 - vulcan.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM "warehouse"."vulcan__vulcan_demo"."vulcan_demo__view_model__938266766" AS "vulcan_demo__view_model__938266766" WHERE NOT "warehouse_performance_tier" IN ('High Performing', 'Medium Performing', 'Low Performing') AND TRUE) AS "audit" (base.py:2622)
2025-12-03 04:57:59,775 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__west": 3696317990> (facade.py:726)
2025-12-03 04:57:59,775 - ThreadPoolExecutor-1_1 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."fct_daily_sales__west": 3696317990> (interval.py:215)
2025-12-03 04:57:59,780 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2025-12-03 04:45:00, 2025-12-03 04:55:00) for snapshot SnapshotId<"warehouse"."vulcan_demo"."view_model": 2016917419> (facade.py:726)
2025-12-03 04:57:59,780 - ThreadPoolExecutor-1_3 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."vulcan_demo"."view_model": 2016917419> (interval.py:215)
2025-12-03 04:57:59,793 - MainThread - vulcan.core.context - INFO - Recorded run execution for 19 models (context.py:1947)
2025-12-03 04:57:59,797 - MainThread - vulcan.core.context - INFO - Logged 19 run_exec events (context.py:1972)
2025-12-03 04:57:59,896 - MainThread - vulcan.core.check.executor - INFO - Running checks in 0 catalog batch(es) (executor.py:374)
2025-12-03 04:57:59,900 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:231)
