checks:
  vulcan_demo.dim_customer:
    completeness:
      - missing_count(customer_sk) = 0:
          name: no_missing_customer_sk
          attributes:
            description: "All customers must have a surrogate key"
      
      - missing_count(customer_id) = 0:
          name: no_missing_customer_ids
          attributes:
            description: "All customers must have a customer ID"
      
      - missing_count(customer_name) = 0:
          name: no_missing_customer_names
          attributes:
            description: "All customers must have a name"
      
      - missing_count(email) = 0:
          name: no_missing_emails
          attributes:
            description: "All customers must have an email address"
      
      - row_count > 0:
          name: has_customers
          attributes:
            description: "At least one customer exists in the dimension table"
    
    validity:
      - failed rows:
          name: invalid_email_format
          fail query: |
            SELECT customer_sk, customer_id, email, customer_name
            FROM vulcan_demo.dim_customer
            WHERE email NOT LIKE '%@%' OR email IS NULL
          samples limit: 10
          attributes:
            description: "Email addresses must be in valid format"
      
      - failed rows:
          name: empty_customer_names
          fail query: |
            SELECT customer_sk, customer_id, customer_name, email
            FROM vulcan_demo.dim_customer
            WHERE customer_name IS NULL OR TRIM(customer_name) = ''
          samples limit: 10
          attributes:
            description: "Customer names cannot be empty"
      
      - failed rows:
          name: invalid_region_ids
          fail query: |
            SELECT customer_sk, customer_id, region_id, region_name
            FROM vulcan_demo.dim_customer
            WHERE region_id IS NOT NULL AND region_id <= 0
          samples limit: 10
          attributes:
            description: "Region IDs must be positive if present"
    
    uniqueness:
      - duplicate_count(customer_sk) = 0:
          name: unique_customer_sk
          attributes:
            description: "Customer surrogate keys must be unique"
      
      - duplicate_count(customer_id) = 0:
          name: unique_customer_ids
          attributes:
            description: "Customer IDs must be unique"
      
      - duplicate_count(email) = 0:
          name: unique_emails
          attributes:
            description: "Email addresses must be unique"

