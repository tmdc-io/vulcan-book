models:
  vulcan_demo.stg_products:
    alias: products
    description: "Staging table for product data with supplier information"
    
    dimensions:
      includes:
        - product_sk
        - product_id
        - product_name
        - category
        - list_price
        - supplier_id
        - supplier_name
        - supplier_region_id
      
    measures:
      product_count:
        type: count
        expression: "{products.product_id}"
        description: "Total number of products"
      
      avg_list_price:
        type: avg
        expression: "{products.list_price}"
        format: currency
        description: "Average product list price"
      
      distinct_category_count:
        type: count_distinct
        expression: "{products.category}"
        description: "Number of distinct product categories"
    
    segments:
      high_value_products:
        expression: "{products.list_price} >= 100"
        description: "Products with list price >= $100"
      
      category_by_supplier:
        expression: "{products.category} IS NOT NULL AND {products.supplier_name} IS NOT NULL"
        description: "Products with category and supplier information"
    
    joins:
      orders:
        type: one_to_many
        expression: "{products.product_id} = {orders.item_id}"

