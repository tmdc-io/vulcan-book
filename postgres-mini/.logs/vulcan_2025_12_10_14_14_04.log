2025-12-10 14:14:04,687 - MainThread - vulcan.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:511)
2025-12-10 14:14:06,995 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-12-10 14:14:07,011 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-12-10 14:14:07,013 - ThreadPoolExecutor-2_0 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.vulcan__raw' (evaluator.py:1443)
2025-12-10 14:14:07,013 - ThreadPoolExecutor-2_1 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.vulcan__sales' (evaluator.py:1443)
2025-12-10 14:14:07,019 - ThreadPoolExecutor-2_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ CREATE SCHEMA IF NOT EXISTS "vulcan__raw" (base.py:2622)
2025-12-10 14:14:07,024 - ThreadPoolExecutor-2_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ CREATE SCHEMA IF NOT EXISTS "vulcan__sales" (base.py:2622)
2025-12-10 14:14:07,026 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:125)
2025-12-10 14:14:07,028 - ThreadPoolExecutor-3_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__sales (evaluator.py:1610)
2025-12-10 14:14:07,028 - ThreadPoolExecutor-3_1 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__raw (evaluator.py:1610)
2025-12-10 14:14:07,032 - ThreadPoolExecutor-3_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT current_catalog (base.py:2622)
2025-12-10 14:14:07,036 - ThreadPoolExecutor-3_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT current_catalog (base.py:2622)
2025-12-10 14:14:07,108 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-12-10 14:14:07,108 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-12-10 14:14:07,111 - MainThread - vulcan.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:189)
2025-12-10 14:14:07,124 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage MigrateSchemasStage (evaluator.py:125)
2025-12-10 14:14:07,124 - ThreadPoolExecutor-4_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__sales (evaluator.py:1610)
2025-12-10 14:14:07,129 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT current_catalog (base.py:2622)
2025-12-10 14:14:07,147 - ThreadPoolExecutor-5_0 - vulcan.core.snapshot.evaluator - INFO - Creating table 'warehouse.vulcan__sales.sales__daily_sales__2671854529_schema_tmp' (evaluator.py:2034)
2025-12-10 14:14:07,147 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ CREATE TABLE IF NOT EXISTS "vulcan__sales"."sales__daily_sales__2671854529_schema_tmp" ("order_date" TIMESTAMP, "total_orders" INT, "total_revenue" DOUBLE PRECISION, "last_order_id" VARCHAR) (base.py:2622)
2025-12-10 14:14:07,151 - ThreadPoolExecutor-5_0 - vulcan.core.snapshot.evaluator - INFO - Dry running model 'sales.daily_sales' (evaluator.py:2056)
2025-12-10 14:14:07,151 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT CAST(CAST("raw_orders"."order_date" AS TIMESTAMP) AS TIMESTAMP) AS "order_date", CAST(COUNT("raw_orders"."order_id") AS INT) AS "total_orders", CAST(SUM("raw_orders"."total_amount") AS DOUBLE PRECISION) AS "total_revenue", CAST(MAX("raw_orders"."order_id") AS VARCHAR) AS "last_order_id" FROM "warehouse"."vulcan__raw"."raw__raw_orders__1032938324" AS "raw_orders" WHERE FALSE GROUP BY "raw_orders"."order_date" ORDER BY "order_date" LIMIT 0 (base.py:2622)
2025-12-10 14:14:07,153 - ThreadPoolExecutor-5_0 - vulcan.core.snapshot.evaluator - INFO - Migrating table schema from 'warehouse.vulcan__sales.sales__daily_sales__2671854529_schema_tmp' to 'warehouse.vulcan__sales.sales__daily_sales__2671854529' (evaluator.py:1208)
2025-12-10 14:14:07,153 - ThreadPoolExecutor-5_0 - vulcan.core.snapshot.evaluator - INFO - Altering table 'warehouse.vulcan__sales.sales__daily_sales__2671854529' (evaluator.py:2090)
2025-12-10 14:14:07,155 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'sales__daily_sales__2671854529') AND "nspname" = 'vulcan__sales' (base.py:2622)
2025-12-10 14:14:07,158 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'sales__daily_sales__2671854529_schema_tmp') AND "nspname" = 'vulcan__sales' (base.py:2622)
2025-12-10 14:14:07,159 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ DROP TABLE IF EXISTS "vulcan__sales"."sales__daily_sales__2671854529_schema_tmp" (base.py:2622)
2025-12-10 14:14:07,161 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-12-10 14:14:07,165 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-12-10 14:14:07,167 - ThreadPoolExecutor-6_0 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.sales' (evaluator.py:1443)
2025-12-10 14:14:07,171 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ CREATE SCHEMA IF NOT EXISTS "sales" (base.py:2622)
2025-12-10 14:14:07,172 - ThreadPoolExecutor-7_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.sales (evaluator.py:1610)
2025-12-10 14:14:07,174 - ThreadPoolExecutor-7_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ SELECT current_catalog (base.py:2622)
2025-12-10 14:14:07,184 - ThreadPoolExecutor-8_0 - vulcan.core.snapshot.evaluator - INFO - Updating view 'warehouse.sales.daily_sales' to point at table 'warehouse.vulcan__sales.sales__daily_sales__2671854529' (evaluator.py:1980)
2025-12-10 14:14:07,185 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ DROP VIEW IF EXISTS "sales"."daily_sales" CASCADE (base.py:2622)
2025-12-10 14:14:07,186 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ CREATE VIEW "sales"."daily_sales" AS SELECT * FROM "warehouse"."vulcan__sales"."sales__daily_sales__2671854529" (base.py:2622)
2025-12-10 14:14:07,187 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ COMMENT ON VIEW "sales"."daily_sales" IS 'Daily sales summary with order counts and revenue' (base.py:2622)
2025-12-10 14:14:07,188 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ COMMENT ON COLUMN "sales"."daily_sales"."order_date" IS 'Date of the sales' (base.py:2622)
2025-12-10 14:14:07,188 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ COMMENT ON COLUMN "sales"."daily_sales"."total_orders" IS 'Total number of orders for the day' (base.py:2622)
2025-12-10 14:14:07,188 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ COMMENT ON COLUMN "sales"."daily_sales"."total_revenue" IS 'Total revenue for the day' (base.py:2622)
2025-12-10 14:14:07,189 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: e5672e53e54646c786f4c490d88bd502 */ COMMENT ON COLUMN "sales"."daily_sales"."last_order_id" IS 'Last order ID processed for the day' (base.py:2622)
2025-12-10 14:14:07,191 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-12-10 14:14:07,192 - MainThread - vulcan.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-12-10 14:14:07,215 - MainThread - vulcan.core.context - INFO - ðŸ“‹ Plan/Run completed - recording run execution and preparing checks (run_id=a89862576f74464b87584907b91d93e3, plan_id=e5672e53e54646c786f4c490d88bd502, environment=prod) (context.py:1875)
2025-12-10 14:14:07,215 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:231)
