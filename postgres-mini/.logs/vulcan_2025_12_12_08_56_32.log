2025-12-12 08:56:32,708 - MainThread - vulcan.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:511)
2025-12-12 08:56:35,990 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:125)
2025-12-12 08:56:36,005 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerSchemaCreationStage (evaluator.py:125)
2025-12-12 08:56:36,006 - ThreadPoolExecutor-2_0 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.vulcan__sales' (evaluator.py:1443)
2025-12-12 08:56:36,007 - ThreadPoolExecutor-2_1 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.vulcan__raw' (evaluator.py:1443)
2025-12-12 08:56:36,009 - ThreadPoolExecutor-2_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE SCHEMA IF NOT EXISTS "vulcan__sales" (base.py:2622)
2025-12-12 08:56:36,010 - ThreadPoolExecutor-2_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE SCHEMA IF NOT EXISTS "vulcan__raw" (base.py:2622)
2025-12-12 08:56:36,011 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:125)
2025-12-12 08:56:36,013 - ThreadPoolExecutor-3_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__sales (evaluator.py:1610)
2025-12-12 08:56:36,014 - ThreadPoolExecutor-3_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT current_catalog (base.py:2622)
2025-12-12 08:56:36,028 - ThreadPoolExecutor-4_0 - vulcan.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"warehouse"."sales"."daily_sales_py": 3771426259> (evaluator.py:711)
2025-12-12 08:56:36,030 - ThreadPoolExecutor-4_0 - vulcan.core.snapshot.evaluator - INFO - Creating table 'warehouse.vulcan__sales.sales__daily_sales_py__4260544463' (evaluator.py:2034)
2025-12-12 08:56:36,031 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE TABLE IF NOT EXISTS "vulcan__sales"."sales__daily_sales_py__4260544463" ("order_date" TIMESTAMP, "total_orders" INT, "total_revenue" DECIMAL(18, 2), "last_order_id" TEXT) (base.py:2622)
2025-12-12 08:56:36,037 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ COMMENT ON TABLE "vulcan__sales"."sales__daily_sales_py__4260544463" IS 'Daily sales aggregated by order_date (total orders, revenue, last order id).' (base.py:2622)
2025-12-12 08:56:36,038 - ThreadPoolExecutor-4_0 - vulcan.core.snapshot.evaluator - INFO - Inserting data for snapshot SnapshotId<"warehouse"."sales"."daily_sales_py": 3771426259> (evaluator.py:952)
2025-12-12 08:56:36,042 - ThreadPoolExecutor-4_0 - vulcan.core.snapshot.evaluator - INFO - Inserting batch (2024-01-01 00:00:00, 2025-12-12 00:00:00) into warehouse.vulcan__sales.sales__daily_sales_py__4260544463' (evaluator.py:984)
2025-12-12 08:56:36,043 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT current_catalog (base.py:2622)
2025-12-12 08:56:36,047 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ DELETE FROM "vulcan__sales"."sales__daily_sales_py__4260544463" WHERE TRUE (base.py:2622)
2025-12-12 08:56:36,049 - ThreadPoolExecutor-4_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "vulcan__sales"."sales__daily_sales_py__4260544463" ("order_date", "total_orders", "total_revenue", "last_order_id") SELECT CAST("order_date" AS TIMESTAMP) AS "order_date", CAST("total_orders" AS INT) AS "total_orders", CAST("total_revenue" AS DECIMAL(18, 2)) AS "total_revenue", CAST("last_order_id" AS TEXT) AS "last_order_id" FROM (VALUES "<REDACTED VALUES>") AS "t"("order_date", "total_orders", "total_revenue", "last_order_id") (base.py:2622)
2025-12-12 08:56:36,051 - ThreadPoolExecutor-4_0 - vulcan.core.state_sync.db.facade - INFO - Adding interval (2024-01-01 00:00:00, 2025-12-12 00:00:00) for snapshot SnapshotId<"warehouse"."sales"."daily_sales_py": 3771426259> (facade.py:962)
2025-12-12 08:56:36,051 - ThreadPoolExecutor-4_0 - vulcan.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"warehouse"."sales"."daily_sales_py": 3771426259> (interval.py:215)
2025-12-12 08:56:36,058 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:125)
2025-12-12 08:56:36,058 - MainThread - vulcan.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:192)
2025-12-12 08:56:36,066 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage MigrateSchemasStage (evaluator.py:125)
2025-12-12 08:56:36,066 - ThreadPoolExecutor-5_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.vulcan__sales (evaluator.py:1610)
2025-12-12 08:56:36,068 - ThreadPoolExecutor-5_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT current_catalog (base.py:2622)
2025-12-12 08:56:36,077 - ThreadPoolExecutor-6_0 - vulcan.core.snapshot.evaluator - INFO - Creating table 'warehouse.vulcan__sales.sales__daily_sales__3493399280_schema_tmp' (evaluator.py:2034)
2025-12-12 08:56:36,077 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE TABLE IF NOT EXISTS "vulcan__sales"."sales__daily_sales__3493399280_schema_tmp" ("order_date" TIMESTAMP, "total_orders" INT, "total_revenue" DOUBLE PRECISION, "last_order_id" VARCHAR) (base.py:2622)
2025-12-12 08:56:36,079 - ThreadPoolExecutor-6_0 - vulcan.core.snapshot.evaluator - INFO - Dry running model 'sales.daily_sales' (evaluator.py:2056)
2025-12-12 08:56:36,080 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT CAST(CAST("raw_orders"."order_date" AS TIMESTAMP) AS TIMESTAMP) AS "order_date", CAST(COUNT("raw_orders"."order_id") AS INT) AS "total_orders", CAST(SUM("raw_orders"."total_amount") AS DOUBLE PRECISION) AS "total_revenue", CAST(MAX("raw_orders"."order_id") AS VARCHAR) AS "last_order_id" FROM "warehouse"."vulcan__raw"."raw__raw_orders__3188508878" AS "raw_orders" WHERE FALSE GROUP BY "raw_orders"."order_date" ORDER BY "order_date" LIMIT 0 (base.py:2622)
2025-12-12 08:56:36,080 - ThreadPoolExecutor-6_0 - vulcan.core.snapshot.evaluator - INFO - Migrating table schema from 'warehouse.vulcan__sales.sales__daily_sales__3493399280_schema_tmp' to 'warehouse.vulcan__sales.sales__daily_sales__3493399280' (evaluator.py:1208)
2025-12-12 08:56:36,080 - ThreadPoolExecutor-6_0 - vulcan.core.snapshot.evaluator - INFO - Altering table 'warehouse.vulcan__sales.sales__daily_sales__3493399280' (evaluator.py:2090)
2025-12-12 08:56:36,082 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'sales__daily_sales__3493399280') AND "nspname" = 'vulcan__sales' (base.py:2622)
2025-12-12 08:56:36,086 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT "attname" AS "column_name", "pg_catalog".format_type("atttypid", "atttypmod") AS "data_type" FROM "pg_catalog"."pg_attribute" JOIN "pg_catalog"."pg_class" ON "pg_class"."oid" = "attrelid" JOIN "pg_catalog"."pg_namespace" ON "pg_namespace"."oid" = "relnamespace" WHERE ("attnum" > 0 AND NOT "attisdropped" AND "relname" = 'sales__daily_sales__3493399280_schema_tmp') AND "nspname" = 'vulcan__sales' (base.py:2622)
2025-12-12 08:56:36,087 - ThreadPoolExecutor-6_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ DROP TABLE IF EXISTS "vulcan__sales"."sales__daily_sales__3493399280_schema_tmp" (base.py:2622)
2025-12-12 08:56:36,089 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:125)
2025-12-12 08:56:36,091 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:125)
2025-12-12 08:56:36,093 - ThreadPoolExecutor-7_0 - vulcan.core.snapshot.evaluator - INFO - Creating schema 'warehouse.sales' (evaluator.py:1443)
2025-12-12 08:56:36,094 - ThreadPoolExecutor-7_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE SCHEMA IF NOT EXISTS "sales" (base.py:2622)
2025-12-12 08:56:36,095 - ThreadPoolExecutor-8_0 - vulcan.core.snapshot.evaluator - INFO - Listing data objects in schema warehouse.sales (evaluator.py:1610)
2025-12-12 08:56:36,096 - ThreadPoolExecutor-8_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ SELECT current_catalog (base.py:2622)
2025-12-12 08:56:36,101 - ThreadPoolExecutor-9_0 - vulcan.core.snapshot.evaluator - INFO - Updating view 'warehouse.sales.daily_sales_py' to point at table 'warehouse.vulcan__sales.sales__daily_sales_py__4260544463' (evaluator.py:1980)
2025-12-12 08:56:36,102 - ThreadPoolExecutor-9_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ DROP VIEW IF EXISTS "sales"."daily_sales_py" CASCADE (base.py:2622)
2025-12-12 08:56:36,102 - ThreadPoolExecutor-9_1 - vulcan.core.snapshot.evaluator - INFO - Updating view 'warehouse.sales.daily_sales' to point at table 'warehouse.vulcan__sales.sales__daily_sales__3493399280' (evaluator.py:1980)
2025-12-12 08:56:36,103 - ThreadPoolExecutor-9_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ DROP VIEW IF EXISTS "sales"."daily_sales" CASCADE (base.py:2622)
2025-12-12 08:56:36,103 - ThreadPoolExecutor-9_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE VIEW "sales"."daily_sales_py" AS SELECT * FROM "warehouse"."vulcan__sales"."sales__daily_sales_py__4260544463" (base.py:2622)
2025-12-12 08:56:36,104 - ThreadPoolExecutor-9_1 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ CREATE VIEW "sales"."daily_sales" AS SELECT * FROM "warehouse"."vulcan__sales"."sales__daily_sales__3493399280" (base.py:2622)
2025-12-12 08:56:36,104 - ThreadPoolExecutor-9_0 - vulcan.core.engine_adapter.base - INFO - Executing SQL: /* VULCAN_PLAN[orders360]: 4767a0c8f4fe4cf19d9bed7ccc8b8745 */ COMMENT ON VIEW "sales"."daily_sales_py" IS 'Daily sales aggregated by order_date (total orders, revenue, last order id).' (base.py:2622)
2025-12-12 08:56:36,108 - MainThread - vulcan.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:125)
2025-12-12 08:56:36,108 - MainThread - vulcan.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:141)
2025-12-12 08:56:36,128 - MainThread - vulcan.core.context - INFO - Recorded run event for 1 models (context.py:1902)
2025-12-12 08:56:36,153 - MainThread - vulcan.core.console - WARNING - No data quality checks defined. Create check YAML files to enable quality validation. (console.py:2353)
2025-12-12 08:56:36,154 - MainThread - vulcan.core.console - WARNING - No models with profiles defined. Skipping profiling. (console.py:2353)
2025-12-12 08:56:36,155 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:231)
